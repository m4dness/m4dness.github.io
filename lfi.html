<html dir="rtl" lang="ar">
  <title>Web Security For Life</title>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
}

.topnav {
  overflow: hidden;
  background-color: #333;
}

.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #b300b3;
  color: white;
}
</style>
</head>
<body>
  <div class="topnav">
  <a class="active" href="https://m4dness.github.io/index.html">General</a>
  <a href="https://m4dness.github.io/ssti.html">Server Side Template Injection</a>
  <a href="https://m4dness.github.io/xxe.html">XML External Entities</a>
  <a href="https://m4dness.github.io/lfi.html">Local File Inclusion</a>
  <a href="Empty">Empty</a>
  <a href="Empty">Empty</a>
  <a href="Empty">Empty</a>
</div>
 <div style="text-align: center;"><span style="font-size: x-large;"><strong><span style="color: #800080;"><u><span style="font-size: 300%;">Local File Inclusion<br /></span></u><span style="font-size: medium;"><br /> </span></span></strong><span style="font-size: medium;"><span style="color: #000000;">What the heck is that?</span><strong><span style="color: #800080;"><br /> <br /> </span></strong><span style="color: #000000;">טוב ששאלתם,<br /> Local File Inclusion או בקיצור LFI זו מתקפת web שמאפשרת לנו כתוקפים לבצע מניפולציה על פרמטר שאינו מאובטח ולהיחשף לקבצי שרת דרך אותו פרמטר.<br /> נקודה חשובה בLFI היא שדרכה יש לנו את הדרך גם לRemote Code Execution, בשונה מDirectory Traversal שזו מתקפה שאיתה אנו אך ורק נחשפים לתוכן הקבצים ללא RCE.</span><strong><span style="color: #800080;"><br /> <br /> </span></strong></span></span></div>
<div style="text-align: center;"><span style="font-size: x-large;"><span style="color: #000000;"><span style="font-size: small;"><span style="font-size: medium;">LFI קורה כאשר בקוד צד שרת משתמשים בפונקציית include או require בצורה לא נכונה ומאובטחת,<br /> כאשר אותה פונקציה מקבלת פרמטר שלא עובר שום ולידציה (או בדיקה בצד השרת) בדרך ובעצם מאפשר לנו לנוע בין תיקיות במערכת ההפעלה<br /> של הקורבן ולהיחשף לתוכן של קבצים קריטיים, הדוגמא הכי קלאסית זה הקובץ "/etc/passwd" במערכת ההפעלה לינוקס.</span><br /><span style="font-size: medium;"><u><strong><br /><span style="font-size: large;">אז למה בעצם מתכנתים צריכים להשתמש בפונקציה הזאת?</span></strong></u></span><br /><span style="font-size: medium;">תחשבו על זה, יש לנו אפשרות להכליל תוכן שלם של קובץ אחד באמצעות one liner פשוט במיוחד, ברגע שזה נעשה,<br /> הקובץ שבו הפונקציה ממומשת מושך את כל תוכן הקובץ שהמתכנת צריך להכליל מסיבות כאלו ואחרות, מה שמאוד מקל על תהליך הפיתוח,<br /> בוא נמשיך:<br /> <br /> <u><strong>ראו את הקוד הבא:</strong></u></span></span></span><span style="color: #800080;"><span style="font-size: small;"><br /> </span></span></span><br /><span style="font-size: x-large;"><strong><span style="color: #800080;"><span style="font-size: small;"><span class="token delimiter important" style="box-sizing: border-box; font-weight: bold; color: #fd971f; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">&lt;?php</span> <span class="token variable" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">$file</span> <span class="token operator" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">=</span> <span class="token global" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">$_GET</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">[</span><span class="token string single-quoted-string" style="box-sizing: border-box; color: #a6e22e; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">'file'</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">]</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">;</span> <span class="token keyword" style="box-sizing: border-box; color: #66d9ef; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">include</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">(</span><span class="token string double-quoted-string" style="box-sizing: border-box; color: #a6e22e; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">"websecurity/<span class="token interpolation" style="box-sizing: border-box;"><span class="token variable" style="box-sizing: border-box; color: #f8f8f2;">$file</span></span>"</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">)</span><span class="token punctuation" style="box-sizing: border-box; color: #f8f8f2; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">;</span> <span class="token delimiter important" style="box-sizing: border-box; font-weight: bold; color: #fd971f; font-family: 'Source Code Pro', monospace; font-size: 13.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #1a1a1a; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">?&gt;</span> </span></span></strong></span><br /> <br /><span style="font-size: medium;">יצרנו פרמטר בשם <span style="color: #800080;"><u><strong>file </strong></u></span>שמקבל את קלט המשתמש בבקשת <span style="color: #800080;"><u><strong>GET</strong></u></span>, לאחר ששלחנו את קלט המשתמש,<br /> הקלט ייכנס לתוך פונקציית הinclude והפונקציה תכליל את תוכן הקובץ בדפדפן האינטרנט, כתובת הURL של האתר נראה כך:</span><br /><br /> <span style="font-size: medium;"><span style="color: #800080;"><u><strong>http://127.0.0.1/lfi.php?file=index.html</strong></u></span><br /><br />נראה שהפרמטר מושך את תוכן הקובץ מ<span style="color: #800080;"><strong>index.html</strong></span> ומציג אותו למשתמש, אם אותו פרמטר בשליטתנו,<br /> מה אתם אומרים שנשנה את שם הקובץ לקובץ אחר? (ירד לכם האסימון?)<br />אז נשנה את הבקשה שתיראה כך:</span><br /><span style="font-size: medium;"><br /> <span style="color: #800080;"><strong>http://127.0.0.1/lfi.php?file=../../../../../etc/passwd</strong></span></span><br /><span style="font-size: medium;"><br />ובאנג, יש לנו את התוכן של קובץ הpasswd כלול בתוך דפדפן האינטרנט.</span><br /><u><br /></u><span style="color: #800080;"><span style="font-size: medium;"><strong><u>אבל רגע! היה דיבור על RCE מקודם לא?</u></strong></span></span><span style="font-size: x-large;"><strong><span style="color: #800080;"><br /><br /></span></strong><span style="font-size: small;"><span style="color: #000000;"><span style="font-size: medium;">אתם צודקים לאללה, ניראלכם ששכחתי? אני חי בשביל השיט הזה.<br />אז כן, LFI יכול להוביל לRCE באמצעות פנייה לקובץ שבמידה והוא מכיל פרמטר שיכול להריץ פקודת system כזו או אחרת,<br /> אז תהיה לנו אפשרות הרצת קוד מרחוק, מהסיבה שפונקציית הinclude או הrequire מבצעות קוד php, או בעצם מריצות אותו,<br />תחשבו על סיטואציה שבה יש לנו אפשרות לעלות קבצים לשרת,<br /> ברגע שהצלחנו לעלות קובץ בעל קוד php זדוני שמשתמש בפקודת system או כל פקודה אחרת שתריץ לנו קוד,<br /> תהיה לנו האפשרות להגיע לקובץ באמצעות LFI ובעצם להריץ קוד מרחוק על השרת כאשר נספק לו את הפרמטר של פקודת הsystem.<br />(הקושי הוא להבין לאיפה הקובץ שהעלתם עלה, כלומר באיזה תיקייה ואם בכלל קיימות ההרשאות לגשת ולהריץ מאותה נקודה).</span><br /><br /></span></span></span><strong><span style="color: #800080;"><span style="font-size: 300%;"><br /> </span></span></strong><strong><span style="color: #800080;"><span style="font-size: 300%;"><br /> </span></span></strong></div>
<div style="text-align: center;">&nbsp;</div>
  </body>
</html>
