<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
}

.navbar {
  overflow: hidden;
  background-color: #333; 
}

.navbar a {
  float: left;
  font-size: 16px;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

.subnav {
  float: left;
  overflow: hidden;
}

.subnav .subnavbtn {
  font-size: 16px;  
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.navbar a:hover, .subnav:hover .subnavbtn {
  background-color: purple;
}

.subnav-content {
  display: none;
  position: absolute;
  left: 0;
  background-color: purple;
  width: 100%;
  z-index: 1;
}

.subnav-content a {
  float: left;
  color: white;
  text-decoration: none;
}

.subnav-content a:hover {
  background-color: #eee;
  color: black;
}

.subnav:hover .subnav-content {
  display: block;
}
</style>
</head>
<body>

<div class="navbar">
  <a href="https://m4dness.github.io/index.html">General</a>
  <div class="subnav">
    <button class="subnavbtn">Basic Web Attacks <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content">
      <a href="https://m4dness.github.io/lfi.html">Local File Inclusion</a>
      <a href="Empty">Empty</a>
      <a href="Empty">Empty</a>
    </div>
  </div> 
  <div class="subnav">
    <button class="subnavbtn">Advanced Web Attacks <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content">
      <a href="https://m4dness.github.io/xxe.html">XML External Entities</a>
      <a href="https://m4dness.github.io/ssti.html">Server Side Template Injection</a>
      <a href="Empty">Empty</a>
      <a href="Empty">Empty</a>
    </div>
  </div> 
  <a href="#contact">Contact</a>
</div>
  <p style="text-align: center;"><span style="font-size: 300%;"><u><span style="color: #800080;"><b><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injection</b></span></u><br /></span><br /><br /><span style="font-size: 300%;"><span style="font-size: medium;">כמה זה 7*7? 49?<br />לא יודע איפה למדתם מתמטיקה, אבל זה ממש לא 49, בואו נתווכח על זה.<br /><br />בשביל להבין מדוע 7*7 לא שווה ל49, אתם צריכים להבין מה הרעיון מאחוריי template.<br /><br /><u><b><span style="font-size: x-large;">אז מהם templates?<br /></span></b></u></span></span><br />templates הם פשוט "תבניות" שמכילות.. תוכן.<br />אם יש שרת web, שרובו הוא אותו דבר אך יש חלק ממש קטן שמשתנה מבקשה לבקשה, אז יש סיכוי טוב שהוא משתמש בtemplates.<br />בואו ניקח עמוד פרופיל של אחד המשתמשים שמציג רק את שם המשתמש, לדוגמא:<br /><br /><u><b><span style="color: #ff0000;">User</span></b></u>: <u><b><span style="color: #800080;">John Doh</span></b></u><br /><br />וברגע שנרצה לראות פרופיל של משתמש אחר, רק שם המשתמש המוצג בדף משתנה. (החלק הצבוע בסגול):<br /><br /><span style="font-size: 300%;"><span style="font-size: medium;"><u><b><span style="color: #ff0000;">User</span></b></u>: <u><b><span style="color: #800080;">John Doh</span></b></u><br /><u><b><span style="color: #ff0000;">User</span></b></u>: <u><b><span style="color: #800080;">James Brown</span></b></u></span><br /></span><span style="font-size: medium;"><span style="color: #ff0000;"><u><b>User</b></u></span>: <span style="color: #800080;"><u><b>Roni King</b></u></span></span><br /><br /><span style="font-size: medium;"><u><b>templates מוצגים כך:</b></u></span><br /><u><b><span style="color: #ff0000;">User</span></b></u>: {<u><b><span style="color: #800080;">user.name</span></b></u>}<span style="font-size: 300%;"><br /></span><br /><span style="font-size: 300%;"><span style="font-size: medium;">ניתן לחלק templates לשני חלקים - סטטי ודינמי.<br />באדום - החלק הסטטי (קבוע)<br />בסגול - החלק הדינמי (משתנה)<br />החלק הדינמי תמיד יהיה הערך היחידי שמשתנה ובתוך סוגריים מסולסלות.</span></span><span style="font-size: medium;"><br /><u><b><br />נקודה חשובה היא שלא כל הtemplates מוצגים כך:</b></u><br /></span><u><b><span style="color: #ff0000;">User</span></b></u>: {<u><b><span style="color: #800080;"> user.name </span></b></u>}<br /><br /><span style="font-size: medium;"><u><b>אלא יכולים להיות מוצגים עם דאבל סוגריים מסולסלות:</b></u></span><br /><u><b><span style="color: #ff0000;">User</span></b></u>: {{<span style="color: #800080;"><u><b> user.name </b></u></span>}}<br /><br />זו רק דוגמא למנוע templates שנקרא Jinja <br />שעובד במסגרת פייתון.<br /><br />יש לא מעט סוגי מנועים לtemplates , והסינטקס שאיתו הדף מציג את המידע יכול להשתנות ממנוע למנוע.<br />אבל הרעיון של templates נשאר זהה לכולם.<br /><br /><span style="color: #800080;"><span style="font-size: 300%;"><u><b>Vulnerability<br /></b></u></span></span><span style="font-size: medium;"><span style="color: #000000;"><u>Template injection<br /></u><br />כמו שהשם מרמז, מדובר בפגיעות שמנצלים בעזרת הזרקה, כאשר קלט המשתמש משתלב עם ההגדרה של הtemplate.<br /><u><b>לדוגמא:</b></u><br /><br /><u><b>template </b></u>= "</span><u><b><span style="color: #ff0000;">Bio</span></b></u><span style="color: #000000;">:" {{ </span><span style="color: #800080;"><u><b>user.bio</b></u></span><span style="color: #000000;"> }}<br /><br />בדוגמא הזו המידע מוצג כאשר המידע נמשך מהtemplate וזה בטוח לחלוטין,<br />שכל מה שהוא עושה זה למשוך את המידע, להחזיר ולהציג אותו למשתמש.<br /><br /><u><b> אבל בואו ניקח דוגמא נוספת:</b></u><br /><br /><u><b>template</b></u> = "</span><span style="color: #ff0000;"><u><b>Bio</b></u></span><span style="color: #000000;">:" + </span><u><b><span style="color: #800080;">USER_INPUT</span></b></u></span><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br />אם קלט המשתמש הופך לחלק בתוך ההגדרה של הtemplate, צריכה להידלק נורה אדומה.<br />מהסיבה שלtemplate (או המנוע שעובד מאחורי הקלעים) יש אפשרות לבצע חישובים,הרצת פקודות ועוד, ולכן למשתמש יש אפשרות לבצע אופרציה פשוטה לווידוי הפגיעות כמו:<br /><br /></span><span style="color: #ff0000;"><u><b>Bio:</b></u></span><span style="color: #000000;">": {{ </span><u><b><span style="color: #800080;">7*7 </span></b></u><span style="color: #000000;">}}"<br /><br /><u>וכתוצאה נקבל:<br /></u><br /></span><span style="color: #000000;"><span style="color: #ff0000;"><u><b>Bio:</b></u></span>": </span><u><b><span style="color: #800080;">49</span></b></u><span style="color: #000000;">"<br /><br /><u>או אפילו להריץ פקודות על העמדה הפגועה מרחוק:</u><br /></span></span></span><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br /><span style="color: #ff0000;"><u><b>Bio:</b></u></span>": {{ <u><b><span style="color: #800080;">exec('ls') </span></b></u>}}"<br /></span></span></span><br /><u><b><span style="color: #800080;">נקודה חשובה נוספת היא שהפגיעות היא לא רק בצד שרת אלא בכל הצדדים שאתם מכירים, כל עוד יש שימוש בtemplates.</span><br /><span style="color: #800080;">מדובר בנושא ענק, שבאשכול אחד לא ניתן לסגור את כל הפינות, אך זה הבסיס לפגיעות.</span></b></u><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><u><b><br />ותזכרו, אף פעם אל תסמכו על קוד בשילוב של קלט מהמשתמש, תתייחסו לקלט כלא בטוח, תמיד.<br /><br /></b></u>ולבסוף, 7*7 , זה מה? נכון, זה </span><u><b><span style="color: #800080;"><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injections</span></b></u><span style="color: #000000;"> <br /><br />נשתמע <u><b><img src="https://static.fcdn.co.il/smilies2/closedeyes.gif" alt="" title="Closedeyes" class="inlineimg loading" data-ll-status="loading" border="0" /></b></u></span></span></span></p>
  </body>
</html>
