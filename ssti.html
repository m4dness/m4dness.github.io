<html dir="rtl" lang="ar">
  <title>Web Security For Life</title>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
}

.topnav {
  overflow: hidden;
  background-color: #333;
}

.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #b300b3;
  color: white;
}
</style>
</head>
<body>
  <div class="topnav">
  <a class="active" href="https://m4dness.github.io/index.html">General</a>
  <a href="https://m4dness.github.io/ssti.html">Server Side Template Injection</a>
  <a href="https://m4dness.github.io/xxe.html">XML External Entities</a>
  <a href="#about">About</a>
</div>
<p style="text-align: center;"><span style="font-size: 300%;"><span style="color: #800080;"><b><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injection</b></span><br /></span><br /><br /><span style="font-size: 300%;"><span style="font-size: medium;">כמה זה 7*7? 49?<br />לא יודע איפה למדתם מתמטיקה, אבל זה ממש לא 49, בואו נתווכח על זה.<br />בשביל להבין מדוע 7*7 לא שווה ל49, אתם צריכים להבין מה הרעיון מאחוריי template.<br /><b><span style="font-size: x-large;">אז מהם templates?<br /></span></b></span></span><br />templates הם פשוט "תבניות" שמכילות.. תוכן.<br />אם יש שרת web, שרובו הוא אותו דבר אך יש חלק ממש קטן שמשתנה מבקשה לבקשה, אז יש סיכוי טוב שהוא משתמש בtemplates.<br />בואו ניקח עמוד פרופיל של אחד המשתמשים שמציג רק את שם המשתמש, לדוגמא:<br /><br /><b><span style="color: #ff0000;">User</span></b>: <b><span style="color: #800080;">John Doh</span></b><br /><br />וברגע שנרצה לראות פרופיל של משתמש אחר, רק שם המשתמש המוצג בדף משתנה. (החלק הצבוע בסגול):<br /><br /><span style="font-size: 300%;"><span style="font-size: medium;"><b><span style="color: #ff0000;">User</span></b>: <b><span style="color: #800080;">John Doh</span></b><br /><b><span style="color: #ff0000;">User</span></b>: <b><span style="color: #800080;">James Brown</span></b></span><br /></span><span style="font-size: medium;"><span style="color: #ff0000;"><b>User</b></span>: <span style="color: #800080;"><b>Roni King</b></span></span><br /><br /><span style="font-size: medium;"><b>templates מוצגים כך:</b></span><br /><b><span style="color: #ff0000;">User</span></b>: {<b><span style="color: #800080;">user.name</span></b>}<span style="font-size: 300%;"><br /></span><br /><span style="font-size: 300%;"><span style="font-size: medium;">ניתן לחלק templates לשני חלקים - סטטי ודינמי.<br />באדום - החלק הסטטי (קבוע)<br />בסגול - החלק הדינמי (משתנה)<br />החלק הדינמי תמיד יהיה הערך היחידי שמשתנה ובתוך סוגריים מסולסלות.</span></span><span style="font-size: medium;"><br /><b><br />נקודה חשובה היא שלא כל הtemplates מוצגים כך:</b><br /></span><b><span style="color: #ff0000;">User</span></b>: {<b><span style="color: #800080;"> user.name </span></b>}<br /><br /><span style="font-size: medium;"><b>אלא יכולים להיות מוצגים עם דאבל סוגריים מסולסלות:</b></span><br /><b><span style="color: #ff0000;">User</span></b>: {{<span style="color: #800080;"><b> user.name </b></span>}}<br /><br />זו רק דוגמא למנוע templates שנקרא Jinja <br />שעובד במסגרת פייתון.<br /><br />יש לא מעט סוגי מנועים לtemplates , והסינטקס שאיתו הדף מציג את המידע יכול להשתנות ממנוע למנוע.<br />אבל הרעיון של templates נשאר זהה לכולם.<br /><br /><span style="color: #800080;"><span style="font-size: 300%;"><b>Vulnerability<br /></b></span></span><span style="font-size: medium;"><span style="color: #000000;">Template injection<br /><br />כמו שהשם מרמז, מדובר בפגיעות שמנצלים בעזרת הזרקה, כאשר קלט המשתמש משתלב עם ההגדרה של הtemplate.<br /><b>לדוגמא:</b><br /><br /><b>template </b>= "</span><b><span style="color: #ff0000;">Bio</span></b><span style="color: #000000;">:" {{ </span><span style="color: #800080;"><b>user.bio</b></span><span style="color: #000000;"> }}<br /><br />בדוגמא הזו המידע מוצג כאשר המידע נמשך מהtemplate וזה בטוח לחלוטין,<br />שכל מה שהוא עושה זה למשוך את המידע, להחזיר ולהציג אותו למשתמש.<br /><br /><b> אבל בואו ניקח דוגמא נוספת:</b><br /><br /><b>template</b> = "</span><span style="color: #ff0000;"><b>Bio</b></span><span style="color: #000000;">:" + </span><b><span style="color: #800080;">USER_INPUT</span></b></span><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br />אם קלט המשתמש הופך לחלק בתוך ההגדרה של הtemplate, צריכה להידלק נורה אדומה.<br />מהסיבה שלtemplate (או המנוע שעובד מאחורי הקלעים) יש אפשרות לבצע חישובים,הרצת פקודות ועוד, ולכן למשתמש יש אפשרות לבצע אופרציה פשוטה לווידוי הפגיעות כמו:<br /><br /></span><span style="color: #ff0000;"><b>Bio:</b></span><span style="color: #000000;">": {{ </span><b><span style="color: #800080;">7*7 </span></b><span style="color: #000000;">}}"<br /><br />וכתוצאה נקבל:<br /><br /></span><span style="color: #000000;"><span style="color: #ff0000;"><b>Bio:</b></span>": </span><b><span style="color: #800080;">49</span></b><span style="color: #000000;">"<br /><br />או אפילו להריץ פקודות על העמדה הפגועה מרחוק:<br /></span></span></span><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br /><span style="color: #ff0000;"><b>Bio:</b></span>": {{ <b><span style="color: #800080;">exec('ls') </span></b>}}"<br /></span></span></span><br /><b><span style="color: #800080;">נקודה חשובה נוספת היא שהפגיעות היא לא רק בצד שרת אלא בכל הצדדים שאתם מכירים, כל עוד יש שימוש בtemplates.</span><br /><span style="color: #800080;">מדובר בנושא ענק, שבאשכול אחד לא ניתן לסגור את כל הפינות, אך זה הבסיס לפגיעות.</span></b><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><b><br />ותזכרו, אף פעם אל תסמכו על קוד בשילוב של קלט מהמשתמש, תתייחסו לקלט כלא בטוח, תמיד.<br /><br /></b>ולבסוף, 7*7 , זה מה? נכון, זה </span><b><span style="color: #800080;"><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injections</span></b><span style="color: #000000;"> <br />נשתמע <b><img src="https://static.fcdn.co.il/smilies2/closedeyes.gif" alt="" title="Closedeyes" class="inlineimg loading" data-ll-status="loading" style="display: block; margin-left: auto; margin-right: auto;" border="0" /></b></span></span></span></p>
  </body>
</html>
