<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
}

.navbar {
  overflow: hidden;
  background-color: #333; 
}

.navbar a {
  float: left;
  font-size: 16px;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

.subnav {
  float: left;
  overflow: hidden;
}

.subnav .subnavbtn {
  font-size: 16px;  
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.navbar a:hover, .subnav:hover .subnavbtn {
  background-color: purple;
}

.subnav-content {
  display: none;
  position: absolute;
  left: 0;
  background-color: purple;
  width: 100%;
  z-index: 1;
}

.subnav-content a {
  float: left;
  color: white;
  text-decoration: none;
}

.subnav-content a:hover {
  background-color: #eee;
  color: black;
}

.subnav:hover .subnav-content {
  display: block;
}
</style>
</head>
<body>

<div class="navbar">
  <a href="https://m4dness.github.io/index.html">General</a>
  <div class="subnav">
    <button class="subnavbtn">Basic Web Attacks <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content">
      <a href="https://m4dness.github.io/lfi.html">Local File Inclusion</a>
      <a href="Empty">Empty</a>
      <a href="Empty">Empty</a>
    </div>
  </div> 
  <div class="subnav">
    <button class="subnavbtn">Advanced Web Attacks <i class="fa fa-caret-down"></i></button>
    <div class="subnav-content">
      <a href="https://m4dness.github.io/xxe.html">XML External Entities</a>
      <a href="https://m4dness.github.io/ssti.html">Server Side Template Injection</a>
      <a href="Empty">Empty</a>
      <a href="Empty">Empty</a>
    </div>
  </div> 
  <a href="#contact">Contact</a>
</div>
<p style="text-align: center;"><span style="font-size: 300%;"><span style="text-decoration: underline;"><span style="color: #800080;"><strong><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injection</strong></span></span><br /></span><br /><br /><span style="font-size: 300%;"><span style="font-size: medium;">כמה זה 7*7? 49?<br />לא יודע איפה למדתם מתמטיקה, אבל זה ממש לא 49, בואו נתווכח על זה.<br /><br />בשביל להבין מדוע 7*7 לא שווה ל49, אתם צריכים להבין מה הרעיון מאחוריי template.<br /><br /><span style="text-decoration: underline;"><strong><span style="font-size: x-large;">אז מהם templates?<br /></span></strong></span></span></span><br />templates הם פשוט "תבניות" שמכילות.. תוכן.<br />אם יש שרת web, שרובו הוא אותו דבר אך יש חלק ממש קטן שמשתנה מבקשה לבקשה, אז יש סיכוי טוב שהוא משתמש בtemplates.<br />בואו ניקח עמוד פרופיל של אחד המשתמשים שמציג רק את שם המשתמש, לדוגמא:<br /><br /><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: <span style="text-decoration: underline;"><strong><span style="color: #800080;">John Doh</span></strong></span><br /><br />וברגע שנרצה לראות פרופיל של משתמש אחר, רק שם המשתמש המוצג בדף משתנה. (החלק הצבוע בסגול):<br /><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: <span style="text-decoration: underline;"><strong><span style="color: #800080;">John Doh</span></strong></span><br /><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: <span style="text-decoration: underline;"><strong><span style="color: #800080;">James Brown</span></strong></span></span><br /></span><span style="font-size: medium;"><span style="color: #ff0000;"><span style="text-decoration: underline;"><strong>User</strong></span></span>: <span style="color: #800080;"><span style="text-decoration: underline;"><strong>Roni King</strong></span></span></span><br /><br /><span style="font-size: medium;"><span style="text-decoration: underline;"><strong>templates מוצגים כך:</strong></span></span><br /><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: {<span style="text-decoration: underline;"><strong><span style="color: #800080;">user.name</span></strong></span>}<span style="font-size: 300%;"><br /></span><br /><span style="font-size: 300%;"><span style="font-size: medium;">ניתן לחלק templates לשני חלקים - סטטי ודינמי.<br />באדום - החלק הסטטי (קבוע)<br />בסגול - החלק הדינמי (משתנה)<br />החלק הדינמי תמיד יהיה הערך היחידי שמשתנה ובתוך סוגריים מסולסלות.</span></span><span style="font-size: medium;"><br /><span style="text-decoration: underline;"><strong><br />נקודה חשובה היא שלא כל הtemplates מוצגים כך:</strong></span><br /></span><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: {<span style="text-decoration: underline;"><strong><span style="color: #800080;"> user.name </span></strong></span>}<br /><br /><span style="font-size: medium;"><span style="text-decoration: underline;"><strong>אלא יכולים להיות מוצגים עם דאבל סוגריים מסולסלות:</strong></span></span><br /><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">User</span></strong></span>: {{<span style="color: #800080;"><span style="text-decoration: underline;"><strong> user.name </strong></span></span>}}<br /><br />זו רק דוגמא למנוע templates שנקרא Jinja <br />שעובד במסגרת פייתון.<br /><br />יש לא מעט סוגי מנועים לtemplates , והסינטקס שאיתו הדף מציג את המידע יכול להשתנות ממנוע למנוע.<br />אבל הרעיון של templates נשאר זהה לכולם.<br /><br /><span style="color: #800080;"><span style="font-size: 300%;"><span style="text-decoration: underline;"><strong>Vulnerability<br /></strong></span></span></span><span style="font-size: medium;"><span style="color: #000000;"><span style="text-decoration: underline;">Template injection<br /></span><br />כמו שהשם מרמז, מדובר בפגיעות שמנצלים בעזרת הזרקה, כאשר קלט המשתמש משתלב עם ההגדרה של הtemplate.<br /><span style="text-decoration: underline;"><strong>לדוגמא:</strong></span><br /><br /><span style="text-decoration: underline;"><strong>template </strong></span>= "</span><span style="text-decoration: underline;"><strong><span style="color: #ff0000;">Bio</span></strong></span><span style="color: #000000;">:" {{ </span><span style="color: #800080;"><span style="text-decoration: underline;"><strong>user.bio</strong></span></span><span style="color: #000000;"> }}<br /><br />בדוגמא הזו המידע מוצג כאשר המידע נמשך מהtemplate וזה בטוח לחלוטין,<br />שכל מה שהוא עושה זה למשוך את המידע, להחזיר ולהציג אותו למשתמש.<br /><br /><span style="text-decoration: underline;"><strong> אבל בואו ניקח דוגמא נוספת:</strong></span><br /><br /><span style="text-decoration: underline;"><strong>template</strong></span> = "</span><span style="color: #ff0000;"><span style="text-decoration: underline;"><strong>Bio</strong></span></span><span style="color: #000000;">:" + </span><span style="text-decoration: underline;"><strong><span style="color: #800080;">USER_INPUT</span></strong></span></span><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br />אם קלט המשתמש הופך לחלק בתוך ההגדרה של הtemplate, צריכה להידלק נורה אדומה.<br />מהסיבה שלtemplate (או המנוע שעובד מאחורי הקלעים) יש אפשרות לבצע חישובים,הרצת פקודות ועוד, ולכן למשתמש יש אפשרות לבצע אופרציה פשוטה לווידוי הפגיעות כמו:<br /><br /></span><span style="color: #ff0000;"><span style="text-decoration: underline;"><strong>Bio:</strong></span></span><span style="color: #000000;">": {{ </span><span style="text-decoration: underline;"><strong><span style="color: #800080;">7*7 </span></strong></span><span style="color: #000000;">}}"<br /><br /><span style="text-decoration: underline;">וכתוצאה נקבל:<br /></span><br /></span><span style="color: #000000;"><span style="color: #ff0000;"><span style="text-decoration: underline;"><strong>Bio:</strong></span></span>": </span><span style="text-decoration: underline;"><strong><span style="color: #800080;">49</span></strong></span><span style="color: #000000;">"<br /><br /><span style="text-decoration: underline;">או אפילו להריץ פקודות על העמדה הפגועה מרחוק:</span><br /></span></span></span><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><br /><span style="color: #ff0000;"><span style="text-decoration: underline;"><strong>Bio:</strong></span></span>": {{ <span style="text-decoration: underline;"><strong><span style="color: #800080;">exec('ls') </span></strong></span>}}"<br /></span></span></span><br /><span style="text-decoration: underline;"><strong><span style="color: #800080;">נקודה חשובה נוספת היא שהפגיעות היא לא רק בצד שרת אלא בכל הצדדים שאתם מכירים, כל עוד יש שימוש בtemplates.</span><br /><span style="color: #800080;">מדובר בנושא ענק, שבאשכול אחד לא ניתן לסגור את כל הפינות, אך זה הבסיס לפגיעות.</span></strong></span><br /><span style="font-size: 300%;"><span style="font-size: medium;"><span style="color: #000000;"><span style="text-decoration: underline;"><strong><br />ותזכרו, אף פעם אל תסמכו על קוד בשילוב של קלט מהמשתמש, תתייחסו לקלט כלא בטוח, תמיד.<br /><br /></strong></span>ולבסוף, 7*7 , זה מה? נכון, זה </span><span style="text-decoration: underline;"><strong><span style="color: #800080;"><span class="highlight">Server</span> <span class="highlight">Side</span> Template Injections</span></strong></span><span style="color: #000000;"> <br /><br />נשתמע <span style="text-decoration: underline;"><strong><img class="inlineimg loading" title="Closedeyes" src="https://static.fcdn.co.il/smilies2/closedeyes.gif" alt="" border="0" data-ll-status="loading" /></strong></span></span></span></span></p>
  </body>
</html>
